<!DOCTYPE html>
<html>
<head>
<!-- 2016-09-26 Mon 20:35 -->
<meta  charset="utf-8">
<meta  name="viewport" content="width=device-width, initial-scale=1">
<title>EECS 600 (Internet Security) Notes</title>
<meta  name="generator" content="Org-mode">
<meta  name="author" content="Stephen Brennan">
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  pre.src-sh:before    { content: 'sh'; }
  pre.src-bash:before  { content: 'sh'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-R:before     { content: 'R'; }
  pre.src-perl:before  { content: 'Perl'; }
  pre.src-java:before  { content: 'Java'; }
  pre.src-sql:before   { content: 'SQL'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="assets/htmlize.css"/>
<link rel="stylesheet" type="text/css" href="assets/readtheorg.css"/>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
<script type="text/javascript" src="assets/jquery.stickytableheaders.min.js"></script>
<script type="text/javascript" src="assets/readtheorg.js"></script>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2013 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        displayAlign: "center",
        displayIndent: "0em",

        "HTML-CSS": { scale: 100,
                        linebreaks: { automatic: "false" },
                        webFont: "TeX"
                       },
        SVG: {scale: 100,
              linebreaks: { automatic: "false" },
              font: "TeX"},
        NativeMML: {scale: 100},
        TeX: { equationNumbers: {autoNumber: "AMS"},
               MultLineWidth: "85%",
               TagSide: "right",
               TagIndent: ".8em"
             }
});
</script>
<script type="text/javascript"
        src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML"></script>
</head>
<body>
<div id="content">
<h1 class="title">EECS 600 (Internet Security) Notes</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#orgheadline1">1. 2016-04-12 Tuesday</a></li>
<li><a href="#orgheadline2">2. 2016-03-03 Thursday</a></li>
<li><a href="#orgheadline3">3. 2016-03-01 Tuesday</a></li>
<li><a href="#orgheadline4">4. 2016-02-25 Thursday</a></li>
<li><a href="#orgheadline5">5. 2016-02-23 Tuesday</a></li>
<li><a href="#orgheadline6">6. 2016-02-16 Tuesday</a></li>
<li><a href="#orgheadline7">7. 2016-02-18 Thursday</a></li>
<li><a href="#orgheadline8">8. 2016-02-11 Thursday</a></li>
<li><a href="#orgheadline9">9. 2016-02-09 Tuesday</a></li>
<li><a href="#orgheadline10">10. 2016-01-28 Thursday</a></li>
<li><a href="#orgheadline13">11. 2016-01-26 Tuesday</a>
<ul>
<li><a href="#orgheadline11">11.1. Virtual Private Networks</a></li>
<li><a href="#orgheadline12">11.2. Firewalls</a></li>
</ul>
</li>
<li><a href="#orgheadline14">12. 2016-01-21 Thursday</a></li>
<li><a href="#orgheadline17">13. 2016-01-19 Tuesday</a>
<ul>
<li><a href="#orgheadline15">13.1. DNSSEC</a></li>
<li><a href="#orgheadline16">13.2. X.509 Overview</a></li>
</ul>
</li>
<li><a href="#orgheadline21">14. 2016-01-14 Thursday</a>
<ul>
<li><a href="#orgheadline18">14.1. Encryption: Message Authentication Problem</a></li>
<li><a href="#orgheadline19">14.2. HTTPS</a></li>
<li><a href="#orgheadline20">14.3. DNS</a></li>
</ul>
</li>
<li><a href="#orgheadline27">15. 2016-01-12 Tuesday</a>
<ul>
<li><a href="#orgheadline22">15.1. Logistics</a></li>
<li><a href="#orgheadline26">15.2. Encryption and Authentication</a>
<ul>
<li><a href="#orgheadline23">15.2.1. Symmetric encryption:</a></li>
<li><a href="#orgheadline24">15.2.2. Asymmetric encryption</a></li>
<li><a href="#orgheadline25">15.2.3. Uses of Encryption</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-orgheadline1" class="outline-2">
<h2 id="orgheadline1"><span class="section-number-2">1</span> 2016-04-12 Tuesday</h2>
<div class="outline-text-2" id="text-1">
<p>
New Internet Architectures
</p>
<ul class="org-ul">
<li>We've looked at new architectures that prevent DDoS traffic.</li>
<li>However, there are plenty of other unwanted types of traffic online.</li>
<li>We should try to design architectures that solve as many of these problems as
possible.</li>
</ul>

<p>
Desired qualities of a new architecture:
</p>
<ul class="org-ul">
<li>Un-spoof-able</li>
<li>Destination gets control over what traffic it receives</li>
<li>Unwanted traffic is dropped closer to the sender (so that it doesn't consume
too many network/destination resources)</li>
</ul>

<p>
Background: Capabilities
</p>
<ul class="org-ul">
<li>Capabilities are the basic idea behind the two papers we read on new
architectures so far (TVA and Portcullis).</li>
<li>Capability = authorization to communicate with a host.
<ul class="org-ul">
<li>Issued by the recipient.  Specific to the path the traffic takes, and
enforced by routers.  Expires quickly.</li>
</ul></li>
<li>Fundamental flaw: need to request a capability.  By definition, the capability
request traffic can't be protected by capabilities, and thus is vulnerable to
a denial of capability attack (flooding the capability request channel to
starve out legitimate ones).
<ul class="org-ul">
<li>TVA tries to address this by using fair queueing.
<ul class="org-ul">
<li>Conference paper just used the incoming link of the router for fair
queueing.</li>
<li>Journal paper used hierarchical fair queueing, which uses the path tags to
queue requests.</li>
</ul></li>
<li>Portcullis tries to address this with proof-of-work traffic.</li>
</ul></li>
</ul>

<p>
Evasive Internet (EIP)
</p>
<ul class="org-ul">
<li>The only way you can talk to a host is with a capability.</li>
<li>Hosts themselves don't handle the capability request, DNS architecture does!</li>
<li>DNS servers are hosts as well, so you need capabilities to speak with them
too!
<ul class="org-ul">
<li>You get capabilities to speak with a DNS server from a higher-level DNS
server.</li>
</ul></li>
<li>Roots are left "unprotected" since they are actually quite well provisioned
due to multicast routing.</li>
<li>In order to talk to a host, you request a capability from DNS.</li>
<li>In other words, a capability is identified by a "transient" address.</li>
<li>T-Address:
<ul class="org-ul">
<li>Contains source/destination IP, as well as capabilities.</li>
<li>Bound together by a cryptographic signature from RPKI.</li>
</ul></li>
<li>A host may issue a T-address, or a host's authoritative DNS server may do it.</li>
<li>Communication flow:
<ul class="org-ul">
<li>Host gets IP address, LDNS, certificate from DHCP server.  Maybe even gets a
T-address for the LDNS to ease things.</li>
<li>Host asks LDNS for T-address for a hostname.</li>
<li>LDNS can go to ADNS for permission, or it can have permission delegated to
it so that it can sign T-addresses for itself.</li>
<li>There is a source/destination t-addr pair.</li>
<li>The initial packet contains t-address.  Subsequent packets are type 2
frames, which only have a 16B flow label.</li>
</ul></li>
<li>Questions
<ul class="org-ul">
<li>MTU:
<ul class="org-ul">
<li>Bandwidth and MTU sizes are reaching the point that it won't be an issue.
But right now, with some finagling, everything can fit into 1500 bytes.
There is a wasted packet though.</li>
</ul></li>
<li>Traffic overhead
<ul class="org-ul">
<li>Around a max of 6% overhead in traffic.</li>
</ul></li>
<li>Computation overhead
<ul class="org-ul">
<li>Not really answerable without resources to do hardware for this.  Initial
results are on server, implemented in software on top of linux +
netfilter.</li>
</ul></li>
</ul></li>
</ul>
</div>
</div>

<div id="outline-container-orgheadline2" class="outline-2">
<h2 id="orgheadline2"><span class="section-number-2">2</span> 2016-03-03 Thursday</h2>
<div class="outline-text-2" id="text-2">
<p>
<b>Web Scams Continued</b>
</p>

<p>
Hiding Content
</p>
<ul class="org-ul">
<li>Can conditionally serve different content by using the user-agent field.</li>
<li>Hide content from user by making their spammed terms/text invisible.</li>
<li>Hide content from search engine by:
<ul class="org-ul">
<li>Redirecting - using a <code>refresh</code> meta tag.</li>
<li>Redirecting - using a script</li>
<li>Or, probably just dynamically loading content using JS frameworks :/</li>
</ul></li>
</ul>

<p>
Fast-Flux Service Network (FFSN)
</p>
<ul class="org-ul">
<li>Hiding web servers (this is especially relevant for phishing)</li>
<li>Use botnets as CDNs</li>
<li>Almost 30% of all domains advertised in spam are FFSN.</li>
</ul>

<p>
<b>Privacy, Anonymity, Tor</b>
</p>

<p>
Internet is a public network.  Spoofing is pretty easy to do through a variety
of ways.  The routing information necessary for the internet is public.  Even
encryption doesn't help that much, because it encrypts the payload of your
communication, but not the source/destination.  And the source/destination of
your traffic is pretty revealing already.
</p>

<p>
Anonymity = the people who are communicating cannot be identified.  This is
different from confidentiality, where the content of your communication is
secret.
</p>

<p>
Onion Routing
</p>
<ul class="org-ul">
<li>Sender chooses a sequence of routers</li>
<li>Some of these routers may not be trusted, but that's okay</li>
<li>The sender encrypts the routing information in a layer-wise fashion, such
that each router only knows the next router, and a piece of encrypted
information to send to the next one.</li>
<li>You always need at least three intermediaries.</li>
<li>Also, a proper router should wait until it has a few messages to send at the
same time, so that an observer can't just look at its traffic and determine
the path for a person's message.</li>
<li>Both of the above considerations incur heavy latency.</li>
</ul>

<p>
Tor
</p>
<ul class="org-ul">
<li>An implementation of onion routing, focusing on anonymous communication.</li>
<li>Not steganographic - it's easy to know that a client is using Tor.</li>
<li>Also, not difficult for a censor to identify all Tor nodes and block them.
<ul class="org-ul">
<li>Either by enumerating nodes from directory.</li>
<li>Or by simply probing IP addresses to see who runs Tor.</li>
</ul></li>
<li>Tor is an overlay network, and communication between nodes happens with
TLS on TCP.</li>
</ul>

<p>
To create a Tor virtual circuit:
</p>
<ul class="org-ul">
<li>Talk to entry node, do Diffie-Helmann to agree upon a symmetric key.</li>
<li>Then, proxied through the entry node, do Diffie-Helmann with your next
selected node to agree upon another symmetric key.</li>
<li>Continue doing this, proxying through your existing VC, adding new nodes to
your circuit, until you're happy.</li>
</ul>

<p>
To send message:
</p>
<ul class="org-ul">
<li>Client builds circuit as above.</li>
<li>Client then encrypts the message with each symmetric key in reverse path
order.  Then sends message through TLS to first node.</li>
</ul>

<p>
Usage:
</p>
<ul class="org-ul">
<li>Many applications can share a circuit, since making a circuit takes time.</li>
<li>Tor routers don't need root.</li>
<li>You're safe so long as not all of your routers are controlled by the same
adversary.</li>
<li>Sybil attack is when an adversary submits a lot of routers to the directory
in order to increase the likelihood of controlling all nodes in a path.</li>
</ul>

<p>
Hidden Services
</p>
<ul class="org-ul">
<li>You want to host a site that nobody can find.</li>
<li>Your service is identified by a public key.</li>
<li>You choose a bunch of introduction points and set up onion routes to each.</li>
<li>Clients up a route to a "rendezvous point" (special piece of software)</li>
<li>Then, client communicates that information to an introduction point
(probably also through an onion route), which conveys it to you.</li>
<li>You set up your own onion route to the rendezvous point.</li>
<li>The rendezvous point "splices" the communications together, and you're
talking.</li>
</ul>
</div>
</div>

<div id="outline-container-orgheadline3" class="outline-2">
<h2 id="orgheadline3"><span class="section-number-2">3</span> 2016-03-01 Tuesday</h2>
<div class="outline-text-2" id="text-3">
<p>
<b>Spam, Continued</b>
</p>

<p>
Forging email from addresses.
</p>
<ul class="org-ul">
<li>You can forge a from address in the SMTP <code>MAIL FROM</code> command.  This is used
by each SMTP server along the delivery path.  Each of the servers can use
this <code>MAIL FROM</code> command to bounce messages when necessary.  This address is
saved in the <code>Return-Path</code> header, so that mail servers can send bounced
messages back to the "correct" sender.</li>
<li>You can also forge a from address by putting it in the <code>From</code> header.  This
is usually what's presented to the user, and this can deceive users.</li>
</ul>

<p>
Reflection attacks using forgery:
</p>
<ol class="org-ol">
<li>Send a message spoofing the <code>MAIL FROM</code> to an invalid address.</li>
<li>The destination mail server will "bounce" the message back to the return
path.</li>
<li>It will send a bounce message to the spoofed address.</li>
</ol>

<p>
This technique can be used to deliver spam, and also pollute the storage of
mail servers.
</p>

<p>
There are techniques to validate both the <code>MAIL FROM</code> command and the <code>From</code>
header.
</p>

<p>
Sender Policy Framework (SPF)
</p>
<ul class="org-ul">
<li>This technique protects the <code>MAIL FROM</code> command.</li>
<li>When a SMTP client says <code>MAIL FROM: person@example.com</code>, the server verifies
the client IP address is allowed to send mail from <code>example.com</code>.</li>
<li>To do this, there is a SPF DNS record that will contain IP addresses of
outbound MTAs for a domain.</li>
<li>Problem: what about using relays?  Say, there's a MTA in between sender MTA
and recipient MTA?  In that case, the relay MTA will not pass SPF.
<ul class="org-ul">
<li>Well, the relay can construct a new email address at their domain, and
then deploy SPF on their domain.  This is called envelope rewrite.</li>
<li>However, this means that the recipient MTA will have to trust that the
relay MTA has done their due diligence for checking SPF.  They cannot
verify the origin MTA's SPF.</li>
</ul></li>
<li>Other limitations:
<ul class="org-ul">
<li>Doesn't prevent forgery of "From:" header.</li>
<li>Doesn't prevent forgery of addresses within the origin domain.</li>
<li>Single broken (non SPF verifying) relay defeats the whole scheme.</li>
</ul></li>
</ul>

<p>
Domain Keys (Aka DKIM)
</p>
<ul class="org-ul">
<li>This technique protects the <code>From</code> header.</li>
<li>Sender publishes their DKIM key using DNS.</li>
<li>Sender adds a <code>DKIM-Signature</code> header, which gives a signature of the
message.
<ul class="org-ul">
<li>Includes the signature algorithm, as well as a list of headers (in order)
that should be prepended to the message before verifying the signature.</li>
</ul></li>
<li>Limitations (mirroring SPF's limitations):
<ul class="org-ul">
<li>Doesn't check SMTP commands: return-path, or recipients.  So even though
the <code>To</code> header is included in the signature, the <code>RCPT TO</code> command is not
verified.</li>
<li>This means that if a spammer succeeds in getting a single message signed,
they can send it out to tons of recipients, and it'll appear valid.</li>
</ul></li>
</ul>

<p>
Other Techniques
</p>
<ul class="org-ul">
<li>Detect spam based on campaigns - when the same message is sent many times.
<ul class="org-ul">
<li>Server can store hashes of messages and note when multiple recipients get
the same message.</li>
<li>Server can also do P2P messages to other MTAs to verify whether other
recipients at those servers have received a message with the same hash.</li>
</ul></li>
<li>Phishing Detection
<ul class="org-ul">
<li>Fetch referenced page.</li>
<li>Extract 5 representative terms out of the page (TF-IDF).</li>
<li>Google search them, and compare the hostname of the link to the top 30
Google results.</li>
</ul></li>
</ul>

<p>
<b>Web Spam</b>
</p>
<ul class="org-ul">
<li>Goal: attract a viewer through search.</li>
<li>Grey area: search engine optimizers.</li>
<li>Two attacks: boost your search result, or hide other search result.</li>
</ul>

<p>
Boosting:
</p>
<ul class="org-ul">
<li>Term spamming
<ul class="org-ul">
<li>Putting terms into text fields and headers of the page.</li>
<li>Put it into the URL.</li>
<li>Put it into links pointing at the page.</li>
<li>Put lots of terms in the page, to make it relevant to many queries.</li>
<li>Or, repeat a term many times to make your page rank higher for that term.</li>
</ul></li>
<li>Link spamming
<ul class="org-ul">
<li>Publish lots of blog entries that link to your URL.</li>
<li>Create websites and pages that link to you.  There is a market for selling
links from your pages to other people's pages, in return for getting
people to link to your page.</li>
<li>Honeypot: put a useful resource online, and include hidden links to spam
pages.</li>
</ul></li>
</ul>
</div>
</div>

<div id="outline-container-orgheadline4" class="outline-2">
<h2 id="orgheadline4"><span class="section-number-2">4</span> 2016-02-25 Thursday</h2>
<div class="outline-text-2" id="text-4">
<p>
We're finished with Denial of Service Attacks.  Now, we're going to talk about
spam.
</p>

<p>
<b>Spam, Ham, Scam</b>
</p>

<p>
In particular, today we'll talk about email spam.
</p>
<ul class="org-ul">
<li>Spam = unwanted mail, containing ads, phishing, or anything else that will
get you to click and get infected.</li>
<li>It has a low uptake rate - about 1%.  Spammers don't seem to mind, they just
increase volume.</li>
<li>Techniques for blacklisting:
<ul class="org-ul">
<li>Blacklist email addresses.
<ul class="org-ul">
<li>Can be spoofed</li>
</ul></li>
<li>By IP address of sending machine
<ul class="org-ul">
<li>difficult to spoof</li>
<li>Can be circumvented with botnets, etc</li>
</ul></li>
<li>Block website
<ul class="org-ul">
<li>Can be circumvented by fast-flux networks.</li>
</ul></li>
</ul></li>
</ul>

<p>
Spam Protection
</p>
<ul class="org-ul">
<li>Content filtering</li>
<li>Message filtering
<ul class="org-ul">
<li>That is, filtering base on non-content features.</li>
<li>For instance, distance between sender and recipient.</li>
<li>Non-content features are harder for attackers to spoof.</li>
</ul></li>
<li>Transfer-time games
<ul class="org-ul">
<li>Receiver may increase download time for message.</li>
<li>For normal senders, this isn't a big deal.</li>
<li>For spammers, time is money.</li>
</ul></li>
<li>Monetary approaches
<ul class="org-ul">
<li>Make the sender pay to send.</li>
<li>Make the sender post a bond that is forfeited if the recipient claims
spam.</li>
</ul></li>
<li>Originator blacklisting</li>
</ul>

<p>
Content &amp; Message Filtering
</p>
<ul class="org-ul">
<li>Run software on your receiving SMTP server.  Extracts features and
classifies as messages come in.</li>
<li>Content-based features:
<ul class="org-ul">
<li>HTML w/ lots of hyperlinks</li>
<li>Lots of heavy formatting, red text, big fonts, etc</li>
<li>Exclamation marks</li>
<li>Lots of misspelling</li>
<li>Specific keywords</li>
</ul></li>
<li>Transport-based features.
<ul class="org-ul">
<li>Path latency, bandwidth
<ul class="org-ul">
<li>Latency correlates with distance, bandwidth correlates with location
(home vs server)</li>
</ul></li>
<li>Inter-packet arrival jitter</li>
<li>Times that a zero-window was advertised (interesting&#x2026;)</li>
</ul></li>
<li>Network-based
<ul class="org-ul">
<li>Dynamic originator address</li>
<li>Source AS number</li>
<li>Distance of source from recipient</li>
<li>Residual TTL in IP header.</li>
</ul></li>
<li>Per-message features</li>
<li>Aggregate features
<ul class="org-ul">
<li>Per-sender: sender age, sending patterns</li>
<li>Across senders: common content</li>
<li>Cross recipients: cooperative filtering</li>
</ul></li>
</ul>

<p>
Spam Filter Pro/Con
</p>
<ul class="org-ul">
<li>Pro
<ul class="org-ul">
<li>Autonomously applied</li>
<li>Effective</li>
<li>Killer app for machine learning (naive bayes woo!)</li>
</ul></li>
<li>Con
<ul class="org-ul">
<li>Constant arms race</li>
<li>False negatives - Lets some spam through (encourages more spam)</li>
<li>False positives - block legitimate mail (change email usage)</li>
</ul></li>
</ul>

<p>
Blacklisting
</p>
<ul class="org-ul">
<li>As discussed above, based on email, IP, etc.</li>
<li>Open-relay SMTP servers are very prized by spammers, very heavily
blacklisted.</li>
<li>Blacklists can be maintained via DNS:
<ul class="org-ul">
<li>Query: A 12-34-56-78.emailblacklist.com?</li>
<li>Response (OK): 12-34-56-78.emailblacklist.com A 10.0.0.0</li>
<li>Response (BL): 12-34-56-78.emailblacklist.com A 10.0.0.1</li>
</ul></li>
</ul>

<p>
Address Aliasing
</p>
<ul class="org-ul">
<li>Multiple email addresses, something we commonly do.</li>
<li>There are actually services that create email addresses with policies
(number of emails, length of time valid, etc).  These services will enforce
these policies, forward messages that adhere, and take care of everything
for you.</li>
</ul>
</div>
</div>

<div id="outline-container-orgheadline5" class="outline-2">
<h2 id="orgheadline5"><span class="section-number-2">5</span> 2016-02-23 Tuesday</h2>
<div class="outline-text-2" id="text-5">
<p>
<b>Content Delivery Networks: Protection or Threat?</b>
</p>

<p>
CDNs claim to provide protection against "flash crowds" as well as against
application-level DDoS attacks.  We will see that their claims are a bit
overblown, and that CDNs can in fact be brought down by DDoS attacks.
</p>

<p>
CDN Background
</p>
<ul class="org-ul">
<li>Main site (example.com) delegates one or more domain to the CDN via DNS
CNAME.</li>
<li>CDN has distributed network of edge servers, and clients are directed to an
edge server by their DNS.</li>
<li>CDN serves "additional" files such as JS, CSS, images, etc.  Some amount of
dynamic content usually must be served by the edge server, but the rest is
cached by the CDN.</li>
</ul>

<p>
Contribution of this paper: an attack that penetrates CDNs, and actually uses
them as accomplices in an amplification attack:
</p>
<ul class="org-ul">
<li>Need to be able to scan the CDN platform to discover edge servers.</li>
<li>Need to be able to obtain service from an arbitrary edge server (not just
the one the CDN chooses for you).</li>
<li>Need to penetrate the CDN cache, ensuring that the origin server is
contacted each time.</li>
<li>Finally, the attack should provide amplification.</li>
</ul>

<p>
Enumerating edge servers:
</p>
<ul class="org-ul">
<li>Simply perform DNS resolutions all over the world.</li>
</ul>

<p>
Penetrating the edge server cache:
</p>
<ul class="org-ul">
<li>First idea: HTTP Cache-Control header.  Instruct edge server not to use
cache.
<ul class="org-ul">
<li>Many CDNs do not honor the header.</li>
</ul></li>
<li>Solution: add random string after the <code>?</code>.  The CDN cache may treat the
whole URL path as a key into their cache, including the parameters.  So a
random string would cause a cache miss.</li>
<li>To test this hypothesis, run three tests:
<ul class="org-ul">
<li>Prewarm cache for a particular object by making a request.  Then make many
subsequent requests and record throughput.</li>
<li>Make an initial request for the object with a random string.  Record
throughput.</li>
<li>Make a subsequent request for the object with the same random string.
Record throughput.</li>
<li>Hypothesis: first and second tests would have different means (t-test), as
well as second and third.  First and third would have the same mean.</li>
<li>Hypothesis was confirmed.</li>
</ul></li>
<li>This avenue for attack can be used against both the CDN as well as the
origin site:
<ul class="org-ul">
<li>Repeated requests with random strings could pollute cache, eventually
evicting valid resources and degrading performance.  It is possible for
the CDN to mitigate this attack (using hashes, bloom filters, etc), but
intuition says that they might not right now.</li>
<li>Repeated requests against the same origin can be used to take down origin
site.</li>
</ul></li>
</ul>

<p>
Amplification!
</p>
<ul class="org-ul">
<li>There are many ways to reduce your own bandwidth consumed during this
attack:
<ul class="org-ul">
<li>Advertise small receive window to throttle connection to CDN.</li>
<li>Or, just cut (RST) connection once you start receiving data from the CDN
(ensuring that they are now consuming origin's bandwidth).</li>
<li>Do both, (advertising 256 byte window), and you can ensure that you are
using very minimal bandwidth from your own computer.</li>
<li>Meanwhile, if you can confirm that the requested object is present in the
cache, you can confirm that the edge server has downloaded the object in
full from the origin, consuming much more bandwidth.  We can use the same
test as above (based on throughput) to confirm that the object does in
fact get cached.</li>
</ul></li>
</ul>

<p>
So, full attack description:
</p>
<ol class="org-ol">
<li>Get the list of IP addresses of the edge servers.</li>
<li>Determine a good-sized object on the victim site.</li>
<li>Attacker sends requests with random strings appended to each of the edge
servers.</li>
<li>Attacker also sets receive window to 256 bytes, and resets connections
after receiving the first data segment.</li>
</ol>

<p>
In order to test this, the researcher also hosts the victim server, and can
monitor the web server for its quality of service.
</p>

<p>
Used Coral CDN, which is a research CDN that can be used for this purpose.
Two attacks: sustained and burst.  Burst tripped rate limiting of CDN, but
sustained attack was not rate limited.
</p>

<p>
The sustained attack achieved 71x decrease in responsiveness from the server.
The burst attack achieved 3 orders of magnitude (1000x) decrease for a shorter
period of time.  The amplification was an order of magnitude.
</p>

<p>
Response from Akamai:
</p>
<ul class="org-ul">
<li>They provide an API to give URL patterns that should be cached.  So, a
website could instruct Akamai not to forward requests with additional GET
parameters on URLs which are not expected to have GET parameters.</li>
</ul>
</div>
</div>

<div id="outline-container-orgheadline6" class="outline-2">
<h2 id="orgheadline6"><span class="section-number-2">6</span> 2016-02-16 Tuesday</h2>
<div class="outline-text-2" id="text-6">
<p>
<b>DDoS Defense by Offense</b>
</p>
</div>
</div>

<div id="outline-container-orgheadline7" class="outline-2">
<h2 id="orgheadline7"><span class="section-number-2">7</span> 2016-02-18 Thursday</h2>
<div class="outline-text-2" id="text-7">
<p>
<b>Thinning Akamai</b>
</p>
</div>
</div>

<div id="outline-container-orgheadline8" class="outline-2">
<h2 id="orgheadline8"><span class="section-number-2">8</span> 2016-02-11 Thursday</h2>
<div class="outline-text-2" id="text-8">
<p>
<b>Web Timeouts and Their Implications</b>
</p>

<p>
Types of (D)Dos
</p>
<ul class="org-ul">
<li>Application attacks
<ul class="org-ul">
<li>frequently HTTP</li>
<li>grab-and-hold</li>
</ul></li>
<li>TCP SYN</li>
<li>Reflection attacks
<ul class="org-ul">
<li>ICMP, TCP SYN, DNS, NTP</li>
<li>Amplification</li>
</ul></li>
</ul>

<p>
Recent Trends
</p>
<ul class="org-ul">
<li>Purpose of this class: to dispel the false sense of security that "we have
the security measures, we are fine."</li>
<li>Security is not a solved problem, it's an ongoing battle</li>
<li>Further, <i>we are not winning</i>
<ul class="org-ul">
<li>As federal spending on "cyber defense" increases linearly, the amount of
security incidents against federal agencies increases super-linearly.</li>
<li>Corporate attacks are very common, and cost huge amounts of money.</li>
<li>Attacks on national infrastructure are becoming much more common.</li>
</ul></li>
<li>With impending integration of our everyday lives on the Internet ("Internet
of Things"), this could be a "disaster in the making".</li>
<li>Top 85% of attacks
<ul class="org-ul">
<li>HTTP Flood, TCP Flood, and DNS Flood</li>
<li>DNS flood is the top attack (42% of all attacks)</li>
</ul></li>
</ul>

<p>
Claim and Hold DoS Attacks
</p>
<ul class="org-ul">
<li>The idea
<ul class="org-ul">
<li>Claim a resource on the server, and hold onto it for a long time.</li>
<li>Because the request is well formed, it is difficult to filter out.</li>
</ul></li>
<li>Examples
<ul class="org-ul">
<li>Slowlory: attacks HTTP servers, sending requests one byte at a time.</li>
<li>Slowdroid: Attacks any TCP server by sending an endless sequence of spaces</li>
</ul></li>
<li>Web server example:
<ul class="org-ul">
<li>Opportunities:
<ul class="org-ul">
<li>Send a SYN, wait for completed handshake.</li>
<li>After handshake is completed, start transmitting request s-l-o-w-l-y</li>
<li>After request is completed, consume the response s-l-o-w-l-y (using TCP
small receive window, and small amounts of acknowledgements).</li>
<li>After response is completed, hold onto the the connection as long as
possible.</li>
</ul></li>
<li>Server has to combat these attacks with timeouts:
<ul class="org-ul">
<li>Application timeout: time from completing handshake to receiving first
byte of request</li>
<li>Request timeout: time from receiving first to last byte of request</li>
<li>Response timeout: time for the client to consume the entire response</li>
<li>TCP timeout: time the server holds onto the connection without receiving
ACKs.</li>
<li>Keep-Alive timeout: time the server will keep a connection alive after
the response is completed.</li>
</ul></li>
</ul></li>
</ul>

<p>
TCP Timeout
</p>
<ul class="org-ul">
<li>Time server allows for client to ACK a data packet.</li>
<li>Send a HTTP request, disappear, and measure one of the following
<ul class="org-ul">
<li>Time of last retransmission (this is a lower bound on the timeout, 61% of
servers).
<ul class="org-ul">
<li>The majority of these servers persist over 100 seconds!</li>
</ul></li>
<li>Or FIN (9% of servers).
<ul class="org-ul">
<li>The majority of these persist under 10 seconds, but some go longer.</li>
</ul></li>
<li>Or RST (30% of servers).
<ul class="org-ul">
<li>The majority of these servers persist over 100 seconds as well!</li>
</ul></li>
</ul></li>
<li>To measure the effect of reducing the TCP timeout, two web servers were
deployed:
<ul class="org-ul">
<li>One which used the regular Linux TCP timeout: 15 retransmissions,
exponential backoff, 13-30 minutes total!</li>
<li>One which used 3 retransmissions, ~600 ms (each?).</li>
<li>Dropped connections due to timeouts increased by 0.16%.  So barely at all.</li>
</ul></li>
</ul>

<p>
Application Timeout
</p>
<ul class="org-ul">
<li>Time the server allows from completing the connection handshake until
receiving the first byte of the HTTP request.</li>
<li>Method: Open a TCP connection, don't send a request, and observe how long we
can keep it open.</li>
<li>About 36% of sites don't terminate after 20 minutes of waiting.  This may be
due to the TCP DEFER ACCEPT option of TCP stacks, which allows the server to
defer "accepting" the TCP connection until the first byte of the request
comes in.</li>
<li>Many sites have timeouts over 100s.</li>
<li>99% of requests happen within a second of the handshake completion.  This is
a huge disconnect from the allowed timeouts.</li>
</ul>

<p>
Request Timeout
</p>
<ul class="org-ul">
<li>Time from receiving first byte of the HTTP request to receiving the last
byte of the request.</li>
<li>Method: open connection, send 1000-bytes HTTP GET request, one byte per
segmet, one segment per second.  Observe if (or when) the connection is
terminated.</li>
<li>Majority of sites didn't close connection.</li>
<li>85% of requests fit within 1 packet.</li>
<li>99.9% of requests take less than 1 second to be transmitted.</li>
</ul>

<p>
Response Timeout
</p>
<ul class="org-ul">
<li>Time for client to consume entire response (bytes/second)</li>
<li>Method: open a connection, send a request, consume the response at 100
bytes/sec.  Observe if server terminates the question.</li>
<li>Only 24% of sites impose a limit on response rate.
<ul class="org-ul">
<li>This corresponds to roughly the fraction of IIS servers in the population,
which is the only web server known to impose a response rate limit.</li>
</ul></li>
<li>Almost 99% of responses are consumed at a rate of at least 10 Kbps.</li>
</ul>

<p>
Keep-Alive
</p>
<ul class="org-ul">
<li>This is much better addressed, since many people are aware of this timeout
and restrict it.</li>
</ul>
</div>
</div>

<div id="outline-container-orgheadline9" class="outline-2">
<h2 id="orgheadline9"><span class="section-number-2">9</span> 2016-02-09 Tuesday</h2>
<div class="outline-text-2" id="text-9">
<p>
<b>Exit from Hell? Reducing the Impact of Amplification DDoS Attacks</b>
</p>

<p>
Read dat paper yo.
</p>
</div>
</div>

<div id="outline-container-orgheadline10" class="outline-2">
<h2 id="orgheadline10"><span class="section-number-2">10</span> 2016-01-28 Thursday</h2>
<div class="outline-text-2" id="text-10">
<p>
Last time - firewall.  Distinguishing feature: interposed in your path to the
network.
</p>

<p>
Today: Intrusion Detection System.  These inspect packets, do "deep packet
inspection", and try to correlate them together to identify attacks and
intrusion attempts.
</p>

<ul class="org-ul">
<li>May have multiple IDS's.  For instance, you may set up a DMZ for publicly
accessible servers, and have a IDS for them.  Then, in the private network,
another IDS.  Finally, you may put further IDS's closer to valuable assets
in order to improve your chances of detection.</li>
<li>Taxonomy of IDS's:
<ul class="org-ul">
<li>Signature based vs anomaly detection
<ul class="org-ul">
<li>Signature based: has classifiers for several different attack types.  If
incoming traffic is classified as an attack, raise an alarm.
<ul class="org-ul">
<li>These can be more accurate, because they can describe specific attacks
that may not look anomalous.</li>
<li>However, they cannot detect new attacks.</li>
</ul></li>
<li>Anomaly detection: creates statistical models for "normal" traffic.
Then raises an alarm when traffic "sticks out" from the normal model.
<ul class="org-ul">
<li>Can detect new attacks</li>
<li>So many false positives</li>
</ul></li>
</ul></li>
<li>Network IDS vs Host IDS
<ul class="org-ul">
<li>NIDS: sniff packets on a whole network.  Requires lots of computing
power.  But, this means that they are monitoring an entire network
segment.</li>
<li>HIDES: Analyzes only at the host-level.  Can use OS-level events (even
TCP state tracking).  Usually deployed on high-value targets.</li>
</ul></li>
</ul></li>
</ul>

<p>
Evasion
</p>
<ul class="org-ul">
<li>Searching for text or patterns within TCP connections is hard.
<ul class="org-ul">
<li>Can't look just for text in a packet (could be spread across multiple)</li>
<li>Can't look just for text in sequential packets (could be reordered)</li>
<li>Could we reassemble the byte stream?  Tricky&#x2026;</li>
</ul></li>
<li>Defining patterns to search for is hard
<ul class="org-ul">
<li>For directory names, could substitute a ton of variations on valid path
names.</li>
<li>Or could use character escapes.</li>
</ul></li>
<li>Packet fragmentation!</li>
<li>As an attacker, any of these variations can be combined.</li>
<li>Additionally, IDS's fail "open", such that the network traffic continues to
flow if an IDS is overwhelmed.  So one common attack is to disable the IDS
by volume or some other way, and then carry on your actual attack without
detection.</li>
<li>TTL Exploit:
<ul class="org-ul">
<li>An attacker may send multiple TCP segments with the same sequence
number, but different payloads, and different TTL fields.</li>
<li>The ones with lower TTL fields will be dropped, so the end host will
only see their intended text.</li>
<li>But IDS will see all the different segments, and have trouble piecing
together the true message.</li>
</ul></li>
<li>Fragmentation Attack:
<ul class="org-ul">
<li>Overlap:
<ul class="org-ul">
<li>Send IP fragment F1 and F2, where F2 overlaps the end of F1.</li>
<li>This is "prohibited" - it should never happen.</li>
<li>But, OS's deal with it in different ways.
<ul class="org-ul">
<li>Some use the data from F1</li>
<li>Some use the data from F2</li>
<li>Some use the first packet to arrive.</li>
</ul></li>
<li>IDS can't guess behavior of every end system</li>
</ul></li>
<li>Reassembly:
<ul class="org-ul">
<li>Network stacks need to hold onto packets that are fragmented, so that
when they receive the next one, they can piece them together.</li>
<li>They have a timeout on their buffers, so that they don't hold them
indefinitely.</li>
<li>If the end host has a longer timer than the IDS:
<ul class="org-ul">
<li>Send F1, wait for the IDS to timeout, then send F2</li>
</ul></li>
<li>If the IDS has a longer timer than the end-host:
<ul class="org-ul">
<li>Prepare fragments F1, F2, F2', such that F1F2 is an attack, but
F1F2' looks ok.</li>
<li>Send F1</li>
<li>Wait for end-host to timeout.</li>
<li>Send F2'</li>
<li>&#x2026; (slides)</li>
</ul></li>
</ul></li>
</ul></li>
</ul>

<p>
Port Scan Evasion:
</p>
<ul class="org-ul">
<li>If a computer (Patsy) has deterministic IP IDs, an attacker can send a ping
stream to view the IP ID state.  Then, they can send TCP SYN's to a victim,
spoofed as the Patsy.</li>
<li>If the Victim's port is open, they will SYN ACK to the Patsy, and the PATSY
will RESET back, which uses in IP ID.  The attacker can observe this and
have good evidence that the port is open.</li>
</ul>

<p>
IDS Guidelines
</p>
<ul class="org-ul">
<li>Preventing TTL attacks:
<ul class="org-ul">
<li>Deploy as close to destination hosts as possible</li>
</ul></li>
<li>Preventing fragmentation attacks:
<ul class="org-ul">
<li>Drop fragmented packets at entry</li>
<li>Not a great solution!  What about tunneling?  Fragmentation regularly
happens when tunneling traffic.</li>
</ul></li>
<li>Bifurcation attacks
<ul class="org-ul">
<li>Try to analyze all possibilities.</li>
<li>Also not a good solution.</li>
</ul></li>
</ul>

<p>
Traffic Normalizer
</p>
<ul class="org-ul">
<li>Sit in the path of traffic, and resolves ambiguities.</li>
<li>For fragments, it will use the shortest reassembly timer, and drop the next
packet fragments after the timeout so nobody gets them (either IDS or end
host)</li>
<li>Always rewrite TTL to fixed value.</li>
<li>Always resolve fragment ambiguities in a particular way.</li>
<li>Limitations
<ul class="org-ul">
<li>Can't know application behavior</li>
<li>EG: TCP urgent pointer
<ul class="org-ul">
<li>Some system calls may not return "urgent" data without a special
command.</li>
<li>So, one way you might read "robot", another way may read "root".</li>
<li>The IDS/normalizer can't know how the socket is being used, so it can't
tell about these things.</li>
</ul></li>
</ul></li>
</ul>

<p>
On the bright side, traffic normalizer fails closed, which is good for
preventing attacks, but bad if the attacker wants to cut off internet access.
</p>

<p>
Summary:
</p>
<ul class="org-ul">
<li>NIDS performs stateful deep packet inspection</li>
<li>Difficult - must obtain same view of traffic as the destination.</li>
<li>When IDS view diverges from hosts, problems happen</li>
<li>Normalizers can help keep these views synchronized</li>
</ul>
</div>
</div>

<div id="outline-container-orgheadline13" class="outline-2">
<h2 id="orgheadline13"><span class="section-number-2">11</span> 2016-01-26 Tuesday</h2>
<div class="outline-text-2" id="text-11">
<p>
Today: IPSec, Firewalls.  Next time: Intrusion Detection Systems.  Next
Tuesday: my paper discussion.  Also, be thinking about project ideas (Thu-Tue
after my presentation).
</p>
</div>

<div id="outline-container-orgheadline11" class="outline-3">
<h3 id="orgheadline11"><span class="section-number-3">11.1</span> Virtual Private Networks</h3>
<div class="outline-text-3" id="text-11-1">
<ul class="org-ul">
<li>Institution would like to have completely separate, private network for
security.</li>
<li>But it's expensive to geographically link multiple far apart branches, and
it's nearly impossible (without a really big retractable cable) to connect
roaming employees securely.</li>
<li>So, VPNs provide encrypted transfer across the internet, making things look
like you're connected to the same network.</li>
</ul>

<p>
Can use many technologies to create VPN:
</p>
<ul class="org-ul">
<li>IPsec</li>
<li>TLS</li>
<li>DTLS (datagram TLS = TLS for UDP)</li>
</ul>

<p>
IPsec
</p>
<ul class="org-ul">
<li>data integrity</li>
<li>origin authentication</li>
<li>replay attack prevention</li>
<li>confidentiality</li>
<li>blanket coverage (encrypts all types of packets)</li>
<li>can use it in many different ways
<ul class="org-ul">
<li>one is at the border routers to tunnel to other places</li>
</ul></li>
</ul>

<p>
Security Associations (SA)
</p>
<ul class="org-ul">
<li>state information (including keys) for one direction of communication over
IPsec. Contains:
<ul class="org-ul">
<li>IP addresses of both sides of communication</li>
<li>enryption algorithm and key</li>
<li>type of integrity check used along with authentication key (for signing)</li>
</ul></li>
<li>Security Association Database (SAD) is used to store that state information</li>
<li>Security Policy Database (SPD) is used to determine the rules for which
data grams are "subjected"" to IPsec, and which ones can just go on to the
"secure" side of a IPsec gateway.</li>
</ul>

<p>
IPsec packet structure (went over in class, wasn't really good for writing
down).
</p>

<p>
Summary of IPsec services: a man in the middle
</p>
<ul class="org-ul">
<li>can't see the original contents of a datagram</li>
<li>can't flip bits without detection</li>
<li>can't masquerade as either party by using their IP address</li>
<li>can't replay a datagram</li>
<li>can see the source and destination IP address</li>
</ul>

<p>
Key Exchange??  IKE = Internet Key Exchange
</p>
<ul class="org-ul">
<li>First, Diffie-Helmann a secure channel between two people</li>
<li>Then, do authentication (could be through a variety of ways)</li>
<li>Finally, create two SA's.</li>
</ul>
</div>
</div>

<div id="outline-container-orgheadline12" class="outline-3">
<h3 id="orgheadline12"><span class="section-number-3">11.2</span> Firewalls</h3>
<div class="outline-text-3" id="text-11-2">
<p>
Firewall: Isolates organization's internal network from larger Internet,
allowing some packets to pass, blocking others.
</p>

<p>
Three types:
</p>
<ul class="org-ul">
<li>Statetless</li>
<li>Stateful</li>
<li>Application gateway</li>
</ul>

<p>
Stateless packet filtering:
</p>
<ul class="org-ul">
<li>Only makes decision based on info within the packet
<ul class="org-ul">
<li>source/destination IP address</li>
<li>IP protocol</li>
<li>source/destination port (for UDP and TCP)</li>
<li>other fields from headers</li>
</ul></li>
<li>Examples:
<ul class="org-ul">
<li>block by port numbers to block services like Telnet</li>
<li>block TCP segments with ACK=0, to prevent external hosts from opening TCP
connections with internal hosts</li>
<li>block incoming/outgoing DNS except from approved DNS resolver</li>
</ul></li>
</ul>

<p>
Stateful
</p>
<ul class="org-ul">
<li>EG, TCP connection tracking (yo&#x2026;. PyWall!!!)</li>
</ul>

<p>
Application Gateways
</p>
<ul class="org-ul">
<li>Filters packets by application data as well as their header fields</li>
<li>for example, a web filter</li>
</ul>
</div>
</div>
</div>

<div id="outline-container-orgheadline14" class="outline-2">
<h2 id="orgheadline14"><span class="section-number-2">12</span> 2016-01-21 Thursday</h2>
<div class="outline-text-2" id="text-12">
<p>
Points from "SSL Landscape - A Thorough Analysis of the X.509 PKI Using Active
and Passive Measurements".
</p>

<p>
(Note I would like to discuss at end of class: revocation lists - why aren't
they signed (to address Google's concern about revocation lists)).
</p>

<p>
Read the paper.  The points were from there.
</p>
</div>
</div>

<div id="outline-container-orgheadline17" class="outline-2">
<h2 id="orgheadline17"><span class="section-number-2">13</span> 2016-01-19 Tuesday</h2>
<div class="outline-text-2" id="text-13">
<p>
<b>Defense for DNS</b>
</p>
<ul class="org-ul">
<li>Close resolvers to outside queries!
<ul class="org-ul">
<li>But, WiFi routers frequently offer a "trap door" to indirectly query
resolvers even when they're closed.</li>
<li>Some need to be open (Google public DNS)</li>
</ul></li>
<li>Ultimate solution to DNS security: DNSSEC</li>
</ul>
</div>

<div id="outline-container-orgheadline15" class="outline-3">
<h3 id="orgheadline15"><span class="section-number-3">13.1</span> DNSSEC</h3>
<div class="outline-text-3" id="text-13-1">
<p>
<b>Goals</b>
</p>
<ul class="org-ul">
<li>Origin Authentication: make sure that a response really came from the
authoritative "zone"</li>
<li>Integrity: make sure that the response hasn't been changed</li>
</ul>

<p>
<b>Main Ideas</b>
</p>
<ul class="org-ul">
<li>Each zone gets a public/private key.</li>
<li>Public key goes into a DNSKEY record.</li>
<li>Private key is used to sign records, and since records are typically
static, ideally the private key will be kept offline.</li>
<li>Signature is stored in RRSIG record.</li>
</ul>

<p>
<b>Authenticity of DNSKEY</b>
</p>
<ul class="org-ul">
<li>Get your key signed by your parent's ADNS.
<ul class="org-ul">
<li>When you get authority for your zone, you get your key signed.</li>
<li>Your parent ADNS keeps NS record for your ADNS.</li>
<li>They also keep a DS (Delegation Signature) record to</li>
</ul></li>
<li>Somewhat similar to a CA hierarchy.</li>
</ul>

<p>
<b>Non-Existing Name</b>
</p>
<ul class="org-ul">
<li>When you query for a non-existing name, you return a NXDOMAIN record.</li>
<li>How to trust that, when a man in the middle could simply capture a record
signed once and feed it back to queries for each query?</li>
<li>You would have to sign each NXDOMAIN query individually, which would
require an online private key.</li>
<li>Instead, we use an NSEC record, which specifies a "bracket" between
subdomains (e.g. "a.case.edu" through "d.case.edu"), and says that there
are no valid domains in between them.</li>
<li>All signatures expire (so that this will become invalid after a while).</li>
<li>So, an invalid query would return NXDOMAIN, plus the correct bracket around
the invalid domain.</li>
<li>Sadly, this introduces the problem that now you can easily enumerate all
DNS names in a zone.</li>
<li>Instead, we can hash the valid names, and order those.  We use those
brackets instead!  NSEC3 records!</li>
</ul>

<p>
<b>Chain of Trust</b>
</p>
<ul class="org-ul">
<li>We now have two different trust hierarchies: DNSSEC, and X.509 (that is,
PKI, or the SSL certificate hierarchy).  (There is actually a third
hierarchy for router advertisements, based on the hierarchy of ISP's, etc).</li>
</ul>

<p>
<b>Problems</b>
</p>
<ul class="org-ul">
<li>Although DNSSEC solves authentication and integrity, it makes DNS
reflection attacks worse.
<ul class="org-ul">
<li>This is because it makes responses even bigger, providing a bigger
amplification for reflection attacks.</li>
</ul></li>
<li>Responses are too big for UDP.</li>
<li>As a result, deployment is very low.
<ul class="org-ul">
<li>This may change if we are able to prevent forged source IP addresses.</li>
<li>Or, if a high-profile DNS poisoning attack occurs (e.g. Google).</li>
</ul></li>
</ul>
</div>
</div>

<div id="outline-container-orgheadline16" class="outline-3">
<h3 id="orgheadline16"><span class="section-number-3">13.2</span> X.509 Overview</h3>
<div class="outline-text-3" id="text-13-2">
<p>
Correction of TLS handshake:
</p>
<ul class="org-ul">
<li>The 5th exchange of the TLS handshake presented last time indicated that
the server sends back a master key encrypted with the client's public key.</li>
<li>However, this would allow a hijacking!</li>
<li>Instead, each side generates some random bits, and they are exchanged in
the first two exchanges.  Then, the client sends some bits to the server
encrypted with the server's public key.</li>
<li>Both sides compute the master key from those bits.</li>
</ul>

<p>
<b>Holz, Braun, Kammenhuber, Carle: SSL Landscape (IMC'11)</b>
</p>

<ul class="org-ul">
<li>Analysis of certificates in the wild.</li>
<li>Datasets:
<ul class="org-ul">
<li>Top million Alexa sites. (from 9 vantage points)</li>
<li>Third-party scan of the whole internet.</li>
<li>Passive monitoring of a research institution's 10Gb link.</li>
</ul></li>
</ul>

<p>
<b>Weaknesses of X.509</b>
</p>
<ul class="org-ul">
<li>Any compromised CA can sign a certificate for any domain.
<ul class="org-ul">
<li>DigiNotar attack (2011)</li>
</ul></li>
<li>A compromised EE (end entity) can have an attacker masquerade as it.</li>
<li>If browser doesn't keep up to date with revocation, etc, or if it doesn't
validate at all, they can connect to fraudulent sites.</li>
<li>If users ignore warnings, they can get screwed too.</li>
</ul>
</div>
</div>
</div>

<div id="outline-container-orgheadline21" class="outline-2">
<h2 id="orgheadline21"><span class="section-number-2">14</span> 2016-01-14 Thursday</h2>
<div class="outline-text-2" id="text-14">
</div><div id="outline-container-orgheadline18" class="outline-3">
<h3 id="orgheadline18"><span class="section-number-3">14.1</span> Encryption: Message Authentication Problem</h3>
<div class="outline-text-3" id="text-14-1">
<p>
As we saw last time, if I want to send an encrypted message to Misha, I can
probably easily find a private key associated with him.  However, I have no
way of being certain that the private key I find belongs to him.  Someone
could have maliciously crafted that key so that they could intercept my
encrypted messages to him.
</p>

<p>
One solution to this is to enlist a third-party to help.  If we all trust
this third party, then I can send my public key to them, have them sign it
(encrypt the hash with their private key), and then include that signature
with my key when I send it to Misha.  Misha could verify the signature, and
if he trusts the third party, he can be certain that the certificate belongs
to me.
</p>

<p>
This third party is called a Root Certificate Authority.  These third parties
can, as they sign a public key, delegate the CA power to other entities,
giving them the power to sign keys for themselves.  This creates a trust
hierarchy.  We also have revocation lists for certificates that should no
longer be trusted.
</p>
</div>
</div>

<div id="outline-container-orgheadline19" class="outline-3">
<h3 id="orgheadline19"><span class="section-number-3">14.2</span> HTTPS</h3>
<div class="outline-text-3" id="text-14-2">
<p>
HTTP:
</p>
<ul class="org-ul">
<li>No privacy</li>
<li>No authentication</li>
<li>No message integrity</li>
<li>Vulnerable to hijacking</li>
</ul>

<p>
Need a way to improve this situation.  Enter HTTPS!  HTTPS = HTTP over
TLS. HTTPS Connection startup:
</p>
<ul class="org-ul">
<li>Client &rarr; Server: opens connection with Server</li>
<li>Server &rarr; Client: responds with signed certificate and session ID</li>
<li>Client &rarr; Server: sends some bits (encrypted with Server's public key), also
sends their public key</li>
<li>Server &rarr; Client: adds their own bits, generates a random master key, and
sends that back, encrypted with client public key</li>
<li>Client &rarr; Server: encrypts with the master key a hash of all messages sent
previously, guaranteeing they were the one the server was talking to all
along.</li>
</ul>

<p>
HTTP Benefits;
</p>
<ul class="org-ul">
<li>Authentication - somewhat.  If we can trust our third parties in the
certificate authority hierarchy, we can generally trust for authentication.</li>
<li>Privacy - encrypted communication means people can't listen in after the
initial negotiation</li>
</ul>
</div>
</div>

<div id="outline-container-orgheadline20" class="outline-3">
<h3 id="orgheadline20"><span class="section-number-3">14.3</span> DNS</h3>
<div class="outline-text-3" id="text-14-3">
<p>
Negative Response Rewriting
</p>
<ul class="org-ul">
<li>When you do a DNS query with your local DNS resolver (typically operated by
an ISP), and the result is an error (failure), the resolver may rewrite the
error message with their own message.</li>
<li>ISP responds with a record pointing to a "buy this domain?" page or a
"search" page for you.  How helpful! :(</li>
<li>My ISP (time warner cable) does this &gt;:(</li>
</ul>

<p>
Search Engine Hijacking
</p>
<ul class="org-ul">
<li>ISP redirects www.google.com to their own servers, which communicate with
google for searches, but modify the results, advertise, etc.</li>
<li>Not widespread anymore, because ISPs were caught doing it.</li>
</ul>

<p>
Kaminsky Attack
</p>
<ul class="org-ul">
<li>What if DNS resolver is honest?  Well, it can still be subverted.</li>
<li>An attacker can send queries to DNS servers for random subdomains of
existing domains.</li>
<li>Then, it can spoof the Authoritative DNS server of that domain, and send
back a response that includes a NS record assigning the new nameserver to
be the attacker's.</li>
<li>If the resolver accepts the fake NS record, its cache is polluted, and
everyone who uses that resolver gets records resolved by a fake ADNS
server.</li>
<li>Kaminsky showed that, even with 16-bit transaction identifiers, it is only
a matter of minutes before the attacker can correctly guess the txid and
poison a cache.  Which is not a bad cost at all if you can poison a cache
for a long time.</li>
<li>However, if DNS resolver uses ephemeral ports for receiving the response,
that adds 16 bits more entropy, which makes the attach pretty much
impossible.</li>
</ul>

<p>
Preplay attack
</p>
<ul class="org-ul">
<li>DNS resolvers on home routers can be pretty dumb.</li>
<li>Some don't check for the IP address of the RDNS, or the transaction ID, or
the destination port!</li>
<li>So, the attacker can simply send a request and then an answer, no guessing
required, and poison that household's DNS cache.</li>
</ul>

<p>
You can also use the WiFi DNS forwarders to conduct Kaminsky attacks on ISP
DNS servers that don't accept external queries.  So that's a downer.  The
number of open forwarders has been declining (was 30 million, now is 17
million), but still isn't great.
</p>
</div>
</div>
</div>

<div id="outline-container-orgheadline27" class="outline-2">
<h2 id="orgheadline27"><span class="section-number-2">15</span> 2016-01-12 Tuesday</h2>
<div class="outline-text-2" id="text-15">
</div><div id="outline-container-orgheadline22" class="outline-3">
<h3 id="orgheadline22"><span class="section-number-3">15.1</span> Logistics</h3>
<div class="outline-text-3" id="text-15-1">
<p>
Goals:
</p>
<ul class="org-ul">
<li>Many subfields of networking are fleeting, but a few like Security and
Measurements are long-term.  So the topic of Security is a prudent one to
study.</li>
<li>We will prepare for research in this area by reading papers, presenting
them, and undertaking a research project.</li>
<li>This is not computer security:
<ul class="org-ul">
<li>We will not study buffer overflows, Sql injection, etc.  Nothing that
allows someone to take over a computer.</li>
<li>Instead, we will cover attacks that don't require compromising the
computer, just the network.</li>
</ul></li>
</ul>

<p>
I'm sure topics will be available online, and we'll get to them soon enough.
</p>

<p>
Tasks:
</p>
<ul class="org-ul">
<li>Read papers, write summaries (which "isn't as easy as you think").</li>
<li>Present a paper and lead the discussion on it.</li>
<li>Final exam = project + presentation</li>
</ul>

<p>
Paper Summaries:
</p>
<ul class="org-ul">
<li>Topic
<ul class="org-ul">
<li>1-2 sentence summary of the topic.</li>
<li>Is it a "mechanisms" or "characterizations" paper?
<ul class="org-ul">
<li>Mechanisms: proposes some new technique</li>
<li>Characterizations: measures some property of the internet</li>
<li>Sometimes it's both</li>
</ul></li>
</ul></li>
<li>Key Ideas/Observations
<ul class="org-ul">
<li>1-2 most important ideas</li>
<li>For mechanisms, the ideas behind the mechanisms</li>
<li>For characterizations, the key observations.</li>
</ul></li>
<li>Flaws (1 or 2)</li>
<li>Open Questions (1 or 2)
<ul class="org-ul">
<li>Where can you take the research from here?</li>
</ul></li>
<li>My Impressions
<ul class="org-ul">
<li>1-2 sentences with your impression (is it good or not, why?)</li>
</ul></li>
</ul>

<p>
Your summaries must follow these sections exactly.  Some may be absent, but
everything must have a section.  Due before class so we can discuss (submitted
online via email in plain text).  Note that this is mostly a summary!  Your
opinions on the paper only belong in the small "My Impressions" section.
</p>

<p>
Some questions to ask about the paper, to identify flaws.
</p>

<ul class="org-ul">
<li>Can someone else replicate the results using the paper?</li>
<li>Are the assumptions clear enough?  (Careful, we're not assessing, just
learning).  Do the assumptions potentially bias the paper?</li>
<li>Does the research eliminate alternative explanations of results?</li>
<li>Do conclusions follow logically from evidence.</li>
</ul>

<p>
Dos and don'ts in paper summaries:
</p>

<ul class="org-ul">
<li>Not a review.</li>
<li>Inappropriate characterizations are "comprehensive", or "insufficient
references".</li>
<li>This is what you need to remember 10 years from now.</li>
<li>Value conciseness.</li>
<li>Value specificity: focus on "how", not "what"</li>
</ul>

<p>
Discussion guidelines:
</p>

<ul class="org-ul">
<li>Lecture for about 30-40 minutes.
<ul class="org-ul">
<li>Allocate 2 minutes per slide.  You expect they will be quicker, but
usually your explanations.</li>
</ul></li>
<li>Discussion for 30-40 minutes</li>
<li>Wrap up (5 mins)</li>
</ul>

<p>
Grading:
</p>
<ul class="org-ul">
<li>20% paper presentation.</li>
<li>40% paper summaries</li>
<li>10% class participation (attendance + discussions)</li>
<li>30% final</li>
</ul>

<p>
Office hours 2:40-3:40 Thursday, or by appointment.  Prefix email subject
lines with "eecs600".
</p>
</div>
</div>

<div id="outline-container-orgheadline26" class="outline-3">
<h3 id="orgheadline26"><span class="section-number-3">15.2</span> Encryption and Authentication</h3>
<div class="outline-text-3" id="text-15-2">
<p>
This content will be a brief overview of the basics.  Just enough for our
subsequent discussions on security.
</p>

<p>
Two varieties of encryption: symmetric and asymmetric
</p>
</div>

<div id="outline-container-orgheadline23" class="outline-4">
<h4 id="orgheadline23"><span class="section-number-4">15.2.1</span> Symmetric encryption:</h4>
<div class="outline-text-4" id="text-15-2-1">
<ul class="org-ul">
<li>Two parties share a secret.</li>
<li>Encryption/decryption algorithms scramble/unscramble plaintext using the
key.</li>
<li>Typically very fast, and the key is very small.</li>
<li>However, it is very difficult to distribute keys securely.</li>
</ul>

<p>
Diffie-Hellman's protocol:
</p>

<ol class="org-ol">
<li>Alice and Bob agree to use a prime number p and a base g (which have some
properties we won't discuss).</li>
<li>Alice chooses secret integer a, then sends Bob \(A = g^a \mod p\).  It
turns out that it's very difficult to guess a from A.</li>
<li>Bob chooses secret integer b, then sends Alice \(B = g^b \mod p\).</li>
<li>Alice computes \(s = B^a \mod p = g^{ba} \mod p\)</li>
<li>Bob computes \(s = A^b \mod p = g^{ab} \mod p\).</li>
<li>Alice and Bob now share the secret \(s\).</li>
</ol>

<p>
Invented in 1976!!
</p>
</div>
</div>

<div id="outline-container-orgheadline24" class="outline-4">
<h4 id="orgheadline24"><span class="section-number-4">15.2.2</span> Asymmetric encryption</h4>
<div class="outline-text-4" id="text-15-2-2">
<ul class="org-ul">
<li>Pair of keys, (S,P).  You encrypt with one and decrypt with the other.</li>
<li>With asymmetric encryption, the key exchange is very similar.  We make one
of our keys public, and we simply encrypt messages to others using their
public keys.</li>
</ul>

<p>
Two types of asymmetric key types:
</p>
<ul class="org-ul">
<li>RSA
<ul class="org-ul">
<li>Large (1-4 kbits)</li>
<li>Efficient</li>
</ul></li>
<li>Elliptic curve
<ul class="org-ul">
<li>Small (about 160 bits)</li>
<li>Expensive</li>
</ul></li>
</ul>
</div>
</div>

<div id="outline-container-orgheadline25" class="outline-4">
<h4 id="orgheadline25"><span class="section-number-4">15.2.3</span> Uses of Encryption</h4>
<div class="outline-text-4" id="text-15-2-3">
<ul class="org-ul">
<li>Message Encryption - make it so that only owners of a key can read it.</li>
<li>Message Signature
<ul class="org-ul">
<li>Message may be distributed in the clear.</li>
<li>Only the key owner could have signed it.</li>
<li>Verifies authenticity and that the message has not been modified.</li>
</ul></li>
</ul>

<p>
Authentication (signing) using symmetric keys.
</p>

<ol class="org-ol">
<li>Append the key to the message.</li>
<li>Hash that to get a "message authentication code", and append that to your
original message, and send it.</li>
<li>Recipient can duplicate your actions and verify the message.</li>
</ol>

<p>
Message Authentication using asymmetric keys
</p>

<ol class="org-ol">
<li>Hash the message, and encrypt it with your private key.  Include that as
the signature.</li>
<li>Recipient can decrypt your signature using the public key, hash the
message, and compare the two hashes.</li>
</ol>

<p>
Interesting side note: the signature will necessarily be the same size as
the asymmetric key, which is inconvenient for large keys.
</p>

<p>
Sadly, with asymmetric keys, it's difficult to be certain that a key belongs
to somebody (and isn't being spoofed).  So you need to get keys certified by
a trusted third party.
</p>
</div>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: Stephen Brennan</p>
<p class="date">Created: 2016-09-26 Mon 20:35</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
